!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=18)}({17:function(e,t,n){var i,r,a;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a=function(){"use strict";function e(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest,n=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var i=new FormData;e.data&&Object.keys(e.data).forEach(function(t){i.append(t,e.data[t])}),i.append(e.filename,e.file,e.file.name),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t,n){var i;i=n.response?"".concat(n.response.error||n.response):n.responseText?"".concat(n.responseText):"fail to post ".concat(e," ").concat(n.status);var r=new Error(i);return r.status=n.status,r.method="post",r.url=e,r}(n,0,t));e.onSuccess(function(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}(t))},t.open("post",n,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var r=e.headers||{};for(var a in r)r.hasOwnProperty(a)&&null!==r[a]&&t.setRequestHeader(a,r[a]);return t.send(i),t}}var t={name:"vue-img-inputer",props:{type:{default:"img",type:String},accept:{default:"image/*,video/*",type:String},capture:{default:!1,type:Boolean},id:{default:"",type:String},onChange:{default:null,type:Function},readonly:{type:Boolean,default:!1},readonlyTipText:{default:"不可更改",type:String},bottomText:{default:"点击或拖拽图片以修改",type:String},placeholder:{default:"点击或拖拽选择图片",type:String},value:{default:void 0},icon:{default:"",type:String},aliIcon:{default:"",type:String},maxSize:{default:5120,type:Number},size:{default:"",type:String},imgSrc:{default:"",type:String},nhe:{type:Boolean,default:!1},noHoverEffect:{type:Boolean,default:!1},noMask:{type:Boolean,default:!1},theme:{type:String,default:""},name:{type:String,default:"file"},autoUpload:{type:Boolean,default:!1},action:{type:String,default:void 0},uploadKey:{type:String,default:"file"},extraData:{type:Object,default:function(){}},headers:{type:Object,default:function(){}},withCookie:{type:Boolean,default:!1},onStart:{default:function(){},type:Function},onProgress:{default:function(){},type:Function},onSuccess:{default:function(){},type:Function},onError:{default:function(){},type:Function}},data:function(){return{inputId:"",file:null,dataUrl:"",fileName:"",errText:"",uploading:!1,uploadPercent:0,uploaded:!1,uploadFailed:!1}},computed:{imgSelected:function(){return!!this.dataUrl||!!this.fileName},sizeHumanRead:function(){return this.maxSize<1024?this.maxSize+"K":(this.maxSize/1024).toFixed(this.maxSize%1024>0?2:0)+"M"},sizeClass:function(){if(this.size)return"img-inputer--".concat(this.size)},themeClass:function(){return"img-inputer--".concat(this.theme)},ICON:function(){return this.icon?this.icon:"light"===this.theme?"img":"clip"},iconUnicode:function(){return this.aliIcon||{img:"&#xe624",clip:"&#xe62d",img2:"&#xe62f"}[this.ICON]},processStyle:function(){var e=this.uploadPercent;return{transform:"translate3d(".concat(e-100,"%, 0, 0)")}}},mounted:function(){var e=this;this.inputId=this.id||this.gengerateID(),this.imgSrc&&(this.dataUrl=this.imgSrc),["dragleave","drop","dragenter","dragover"].forEach(function(t){e.preventDefaultEvent(t)}),this.addDropSupport()},methods:{preventDefaultEvent:function(e){document.addEventListener(e,function(e){e.preventDefault()},!1)},addDropSupport:function(){var e=this;this.$refs.box.addEventListener("drop",function(t){if(t.preventDefault(),e.readonly)return!1;e.errText="";var n=t.dataTransfer.files;return 0!==n.length&&(n.length>1?(e.errText="不支持多文件",!1):void e.handleFileChange(n))})},gengerateID:function(){var e=Math.random().toString(36).substring(3,8);return document.getElementById(e)?this.gengerateID():e},handleFileChange:function(e){if(void 0===e.target?this.file=e[0]:this.file=e.target.files[0],this.errText="",Math.floor(this.file.size/1024)>this.maxSize)return this.errText="文件大小不能超过".concat(this.sizeHumanRead),!1;this.$emit("input",this.file),this.autoUpload&&this.uploadFile(),this.onChange&&this.onChange(this.file,this.file.name),this.$emit("onChange",this.file,this.file.name),this.imgPreview(this.file),this.fileName=this.file.name,this.resetInput()},imgPreview:function(e){var t=this;if(e&&window.FileReader&&/^image/.test(e.type)){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){t.dataUrl=this.result}}},resetInput:function(){var e=document.getElementById(this.inputId),t=document.createElement("form");document.body.appendChild(t);var n,i=e.parentNode,r=i.lastChild===e;r||(n=e.nextSibling),t.appendChild(e),t.reset(),r?i.appendChild(e):i.insertBefore(e,n),document.body.removeChild(t)},uploadFile:function(){var e=this.onStart,t=this.file;this.action?(e&&e(t),this.post(t)):this.errText="上传地址未配置"},post:function(t){var n=this,i=this.headers,r=this.withCookie,a=this.extraData,o=this.uploadKey,s=this.action;this.uploading=!0,e({headers:i,withCredentials:r,file:t,data:a,filename:o,action:s,onProgress:function(e){n.uploadPercent=~~e.percent,n.onProgress(e,t)},onSuccess:function(e){n.uploadPercent=0,n.uploading=!1,n.uploaded=!0,n.onSuccess(e,t)},onError:function(e){n.uploadPercent=0,n.uploading=!1,n.uploadFailed=!0,n.onError(e,t)}})},reset:function(){this.file=null,this.dataUrl="",this.errText="",this.fileName="",this.uploadPercent=0,this.uploading=!1,this.uploaded=!1,this.uploadFailed=!1}},watch:{imgSrc:function(e){this.dataUrl=e,e||(this.file=null,this.errText="",this.fileName="")},value:function(e,t){t&&!e&&this.reset()}}},n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"box",staticClass:"img-inputer",class:[e.themeClass,e.sizeClass,e.nhe||e.noHoverEffect?"nhe":"",{"img-inputer--loading":e.uploading}]},[n("i",{staticClass:"iconfont img-inputer__icon",domProps:{innerHTML:e._s(e.iconUnicode)}}),e._v(" "),n("p",{staticClass:"img-inputer__placeholder"},[e._v(e._s(e.placeholder))]),e._v(" "),e.imgSelected?n("div",{staticClass:"img-inputer__preview-box"},[n("img",{staticClass:"img-inputer__preview-img",attrs:{src:e.dataUrl}})]):e._e(),e._v(" "),n("label",{staticClass:"img-inputer__label",attrs:{for:e.readonly?"":e.inputId}}),e._v(" "),n("transition",{attrs:{name:"vip-fade"}},[e.uploading?n("div",{staticClass:"img-inputer__loading"},[n("div",{staticClass:"img-inputer__loading-indicator"}),e._v(" "),n("div",{staticClass:"img-inputer__loading-process",style:e.processStyle})]):e._e()]),e._v(" "),n("transition",{attrs:{name:"vip-zoom-in"}},[e.autoUpload&&e.uploaded?n("div",{staticClass:"img-inputer__state success"}):e._e()]),e._v(" "),n("transition",{attrs:{name:"vip-zoom-in"}},[e.autoUpload&&e.uploadFailed?n("div",{staticClass:"img-inputer__state fail"}):e._e()]),e._v(" "),e.imgSelected&&!e.noMask?n("div",{staticClass:"img-inputer__mask"},[n("p",{staticClass:"img-inputer__file-name"},[e._v(e._s(e.fileName))]),e._v(" "),e.readonly?n("p",{staticClass:"img-inputer__change"},[e._v(e._s(e.readonlyTipText))]):n("p",{staticClass:"img-inputer__change"},[e._v(e._s(e.bottomText))])]):e._e(),e._v(" "),e.capture?n("input",{ref:"inputer",staticClass:"img-inputer__inputer",attrs:{type:"file",name:e.name,id:e.inputId,accept:e.accept,capture:"video"},on:{change:e.handleFileChange}}):n("input",{ref:"inputer",staticClass:"img-inputer__inputer",attrs:{type:"file",name:e.name,id:e.inputId,accept:e.accept},on:{change:e.handleFileChange}}),e._v(" "),n("transition",{attrs:{name:"vip-move-in"}},[e.errText.length?n("div",{staticClass:"img-inputer__err"},[e._v(e._s(e.errText))]):e._e()])],1)};n._withStripped=!0;var i,r,a,o,s;return i={render:n,staticRenderFns:[]},r=void 0===t?{}:t,a=void 0,o=!1,"undefined"!=typeof __vue_create_injector_ssr__&&__vue_create_injector_ssr__,(s=("function"==typeof r?r.options:r)||{}).__file="/Users/wayne/me/vue-img-inputer/src/ImgInputer.vue",s.render||(s.render=i.render,s.staticRenderFns=i.staticRenderFns,s._compiled=!0,o&&(s.functional=!0)),s._scopeId=a,s},"object"===o(t)&&void 0!==e?e.exports=a():void 0===(r="function"==typeof(i=a)?i.call(t,n,t,e):i)||(e.exports=r)},18:function(e,t,n){e.exports=n(17)}});
//# sourceMappingURL=main.d0694a75.js.map