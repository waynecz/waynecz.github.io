!function(e){function t(t){for(var n,o,s=t[0],l=t[1],c=t[2],f=0,d=[];f<s.length;f++)o=s[f],a[o]&&d.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);d.length;)d.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],n=!0,s=1;s<i.length;s++){var l=i[s];0!==a[l]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},a={1:0},r=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([16,0]),i()}([,function(e,t,i){},function(e,t,i){},,,function(e,t,i){"use strict";i.r(t);var n=i(4),a={name:"hello"},r=(i(11),i(0)),o={name:"app",components:{Hello:Object(r.a)(a,function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("h1",[this._v("优雅的图片输入、上传组件")]),this._v(" "),t("h1",[this._v("自动上传、图片预览、拖拽、回填、主题可选、高度可定制")]),this._v(" "),t("small",[this._v("多用于非单个上传，随其余表单字段一起上传的图片")])])}],!1,null,"15dd56e0",null).exports},data:function(){return{file:null,cloudImg:""}},mounted:function(){var e=this;setTimeout(function(){e.cloudImg="http://7xntdk.com1.z0.glb.clouddn.com/2.jpg"},2e3)},methods:{fileChange:function(e,t){console.log("File --\x3e ",e),console.log("FileName --\x3e",t)},onErr:function(e,t){console.log("​onErr -> file",t),console.log("​onErr -> err",e)}}},s=(i(9),Object(r.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("img",{staticClass:"logo",attrs:{width:"400",src:i(12)}}),e._v(" "),n("Hello"),e._v(" "),n("section",{staticClass:"wrapper"},[n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(0)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{"auto-upload":"",action:"//jsonplaceholder.typicode.com/posts/","on-error":e.onErr,accept:"image/*.jpeg"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(1)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",icon:"img"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(2)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",theme:"light"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(3)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",placeholder:"请选择身份证"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(4)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",imgSrc:e.cloudImg},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(5)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",readonly:"",imgSrc:"http://7xntdk.com1.z0.glb.clouddn.com/11.jpg"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(6)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",readonly:"",noMask:"",imgSrc:"http://7xntdk.com1.z0.glb.clouddn.com/12.jpg"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(7)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*","no-hover-effect":""},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(8)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",size:"small"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(9)],1),e._v(" "),n("div",{staticClass:"item"},[n("imgInputer",{attrs:{accept:"image/*",size:"large"},on:{onChange:e.fileChange},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),e._m(10)],1)])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v("default")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v("auto-upload")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('icon="img"')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('theme="light"')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('placeholder="..."')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('img-src="..."')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v("readonly")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v("no-mask")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v("no-hover-effect")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('size="small"')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("code",[this._v('size="large"')])])}],!1,null,null,null).exports);function l(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest,i=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var n=new FormData;e.data&&Object.keys(e.data).forEach(function(t){n.append(t,e.data[t])}),n.append(e.filename,e.file,e.file.name),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t,i){var n;n=i.response?"".concat(i.response.error||i.response):i.responseText?"".concat(i.responseText):"fail to post ".concat(e," ").concat(i.status);var a=new Error(n);return a.status=i.status,a.method="post",a.url=e,a}(i,0,t));e.onSuccess(function(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}(t))},t.open("post",i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var a=e.headers||{};for(var r in a)a.hasOwnProperty(r)&&null!==a[r]&&t.setRequestHeader(r,a[r]);return t.send(n),t}}var c={name:"vue-img-inputer",props:{type:{default:"img",type:String},accept:{default:"image/*,video/*",type:String},capture:{default:!1,type:Boolean},id:{default:"",type:String},onChange:{default:null,type:Function},readonly:{type:Boolean,default:!1},readonlyTipText:{default:"不可更改",type:String},bottomText:{default:"点击或拖拽图片以修改",type:String},placeholder:{default:"点击或拖拽选择图片",type:String},value:{default:void 0},icon:{default:"",type:String},aliIcon:{default:"",type:String},maxSize:{default:5120,type:Number},size:{default:"",type:String},imgSrc:{default:"",type:String},nhe:{type:Boolean,default:!1},noHoverEffect:{type:Boolean,default:!1},noMask:{type:Boolean,default:!1},theme:{type:String,default:""},name:{type:String,default:"file"},autoUpload:{type:Boolean,default:!1},action:{type:String,default:void 0},uploadKey:{type:String,default:"file"},extraData:{type:Object,default:function(){}},headers:{type:Object,default:function(){}},withCookie:{type:Boolean,default:!1},onStart:{default:function(){},type:Function},onProgress:{default:function(){},type:Function},onSuccess:{default:function(){},type:Function},onError:{default:function(){},type:Function}},data:function(){return{inputId:"",file:null,dataUrl:"",fileName:"",errText:"",uploading:!1,uploadPercent:0,uploaded:!1,uploadFailed:!1}},computed:{imgSelected:function(){return!!this.dataUrl||!!this.fileName},sizeHumanRead:function(){return this.maxSize<1024?this.maxSize+"K":(this.maxSize/1024).toFixed(this.maxSize%1024>0?2:0)+"M"},sizeClass:function(){if(this.size)return"img-inputer--".concat(this.size)},themeClass:function(){return"img-inputer--".concat(this.theme)},ICON:function(){return this.icon?this.icon:"light"===this.theme?"img":"clip"},iconUnicode:function(){return this.aliIcon||{img:"&#xe624",clip:"&#xe62d",img2:"&#xe62f"}[this.ICON]},processStyle:function(){var e=this.uploadPercent;return{transform:"translate3d(".concat(e-100,"%, 0, 0)")}}},mounted:function(){var e=this;this.inputId=this.id||this.gengerateID(),this.imgSrc&&(this.dataUrl=this.imgSrc),["dragleave","drop","dragenter","dragover"].forEach(function(t){e.preventDefaultEvent(t)}),this.addDropSupport()},methods:{preventDefaultEvent:function(e){document.addEventListener(e,function(e){e.preventDefault()},!1)},addDropSupport:function(){var e=this;this.$refs.box.addEventListener("drop",function(t){if(t.preventDefault(),e.readonly)return!1;e.errText="";var i=t.dataTransfer.files;return 0!==i.length&&(i.length>1?(e.errText="不支持多文件",!1):void e.handleFileChange(i))})},gengerateID:function(){var e=Math.random().toString(36).substring(3,8);return document.getElementById(e)?this.gengerateID():e},handleFileChange:function(e){if(void 0===e.target?this.file=e[0]:this.file=e.target.files[0],this.errText="",Math.floor(this.file.size/1024)>this.maxSize)return this.errText="文件大小不能超过".concat(this.sizeHumanRead),!1;this.$emit("input",this.file),this.autoUpload&&this.uploadFile(),this.onChange&&this.onChange(this.file,this.file.name),this.$emit("onChange",this.file,this.file.name),this.imgPreview(this.file),this.fileName=this.file.name,this.resetInput()},imgPreview:function(e){var t=this;if(e&&window.FileReader&&/^image/.test(e.type)){var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(){t.dataUrl=this.result}}},resetInput:function(){var e=document.getElementById(this.inputId),t=document.createElement("form");document.body.appendChild(t);var i,n=e.parentNode,a=n.lastChild===e;a||(i=e.nextSibling),t.appendChild(e),t.reset(),a?n.appendChild(e):n.insertBefore(e,i),document.body.removeChild(t)},uploadFile:function(){var e=this.onStart,t=this.file;this.action?(e&&e(t),this.post(t)):this.errText="上传地址未配置"},post:function(e){var t=this,i=this.headers,n=this.withCookie,a=this.extraData,r=this.uploadKey,o=this.action;this.uploading=!0,l({headers:i,withCredentials:n,file:e,data:a,filename:r,action:o,onProgress:function(i){t.uploadPercent=~~i.percent,t.onProgress(i,e)},onSuccess:function(i){t.uploadPercent=0,t.uploading=!1,t.uploaded=!0,t.onSuccess(i,e)},onError:function(i){t.uploadPercent=0,t.uploading=!1,t.uploadFailed=!0,t.onError(i,e)}})},reset:function(){this.file=null,this.dataUrl="",this.errText="",this.fileName="",this.uploadPercent=0,this.uploading=!1,this.uploaded=!1,this.uploadFailed=!1}},watch:{imgSrc:function(e){this.dataUrl=e,e||(this.file=null,this.errText="",this.fileName="")},value:function(e,t){t&&!e&&this.reset()}}},u=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"box",staticClass:"img-inputer",class:[e.themeClass,e.sizeClass,e.nhe||e.noHoverEffect?"nhe":"",{"img-inputer--loading":e.uploading}]},[i("i",{staticClass:"iconfont img-inputer__icon",domProps:{innerHTML:e._s(e.iconUnicode)}}),e._v(" "),i("p",{staticClass:"img-inputer__placeholder"},[e._v(e._s(e.placeholder))]),e._v(" "),e.imgSelected?i("div",{staticClass:"img-inputer__preview-box"},[i("img",{staticClass:"img-inputer__preview-img",attrs:{src:e.dataUrl}})]):e._e(),e._v(" "),i("label",{staticClass:"img-inputer__label",attrs:{for:e.readonly?"":e.inputId}}),e._v(" "),i("transition",{attrs:{name:"vip-fade"}},[e.uploading?i("div",{staticClass:"img-inputer__loading"},[i("div",{staticClass:"img-inputer__loading-indicator"}),e._v(" "),i("div",{staticClass:"img-inputer__loading-process",style:e.processStyle})]):e._e()]),e._v(" "),i("transition",{attrs:{name:"vip-zoom-in"}},[e.autoUpload&&e.uploaded?i("div",{staticClass:"img-inputer__state success"}):e._e()]),e._v(" "),i("transition",{attrs:{name:"vip-zoom-in"}},[e.autoUpload&&e.uploadFailed?i("div",{staticClass:"img-inputer__state fail"}):e._e()]),e._v(" "),e.imgSelected&&!e.noMask?i("div",{staticClass:"img-inputer__mask"},[i("p",{staticClass:"img-inputer__file-name"},[e._v(e._s(e.fileName))]),e._v(" "),e.readonly?i("p",{staticClass:"img-inputer__change"},[e._v(e._s(e.readonlyTipText))]):i("p",{staticClass:"img-inputer__change"},[e._v(e._s(e.bottomText))])]):e._e(),e._v(" "),e.capture?i("input",e._b({ref:"inputer",staticClass:"img-inputer__inputer",attrs:{type:"file",name:e.name,id:e.inputId,accept:e.accept,capture:"video"},on:{change:e.handleFileChange}},"input",e.$attrs,!1)):i("input",e._b({ref:"inputer",staticClass:"img-inputer__inputer",attrs:{type:"file",name:e.name,id:e.inputId,accept:e.accept},on:{change:e.handleFileChange}},"input",e.$attrs,!1)),e._v(" "),i("transition",{attrs:{name:"vip-move-in"}},[e.errText.length?i("div",{staticClass:"img-inputer__err"},[e._v(e._s(e.errText))]):e._e()])],1)},[],!1,null,null,null).exports,f=(i(7),u);n.a.component("imgInputer",f),new n.a({el:"#app",template:"<App/>",components:{App:s}})},,function(e,t,i){},,function(e,t,i){"use strict";var n=i(1);i.n(n).a},,function(e,t,i){"use strict";var n=i(2);i.n(n).a},function(e,t,i){e.exports=i.p+"8fefa2f154529d9c180014f97d21ff91.png"},,,,function(e,t,i){e.exports=i(5)}]);
//# sourceMappingURL=index.3c635f61.js.map