<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Wayne]]></title>
  <subtitle><![CDATA[看多了会瞎]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://waynecz.github.io/"/>
  <updated>2016-04-17T15:36:46.000Z</updated>
  <id>http://waynecz.github.io/</id>
  
  <author>
    <name><![CDATA[Wayne]]></name>
    <email><![CDATA[451578533@qq.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[ES6 Promise 入门]]></title>
    <link href="http://waynecz.github.io/2016/04/17/ES6-Promise-%E5%85%A5%E9%97%A8/"/>
    <id>http://waynecz.github.io/2016/04/17/ES6-Promise-入门/</id>
    <published>2016-04-17T15:35:42.000Z</published>
    <updated>2016-04-17T15:36:46.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/12.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/12.jpg" alt=""></p>
]]>
    </summary>
    
      <category term="javascript" scheme="http://waynecz.github.io/tags/javascript/"/>
    
      <category term="异步流程控制" scheme="http://waynecz.github.io/tags/%E5%BC%82%E6%AD%A5%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[express＋webpack+gulp＋nodemon初级自动化！]]></title>
    <link href="http://waynecz.github.io/2016/04/11/express%EF%BC%8Bwebpack-gulp%EF%BC%8Bnodemon%E5%89%8D%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    <id>http://waynecz.github.io/2016/04/11/express＋webpack-gulp＋nodemon前端自动化/</id>
    <published>2016-04-11T13:26:37.000Z</published>
    <updated>2016-04-17T15:34:33.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/11.jpg" alt=""></p>
<p>主要是为了彻底解放刷新键。。。。。咳咳。开始<br>之前接触React时解除了webpack，不过后来看angular和其他事就搁置了。最近碰到Vue时，体验了下<a href="http://cn.vuejs.org/guide/application.html" target="_blank" rel="external">vue-cli 脚手架</a>构建的项目，只能说，<em>哇！！</em> 好爽。。什么热加载，保存时检查代码，单元测试以及一堆我还不知道的但是很强大的功能！无比顺畅<br><a id="more"></a><br>虽然之前在用的 <code>Gulp</code>加上各种插件貌似也能达到差不多的效果，但是还是心痒，所以这几天笨手笨脚地学者搭了<a href="https://github.com/waynecz/Thrones" target="_blank" rel="external">这个</a>, 一个OA的demo。</p>
<p>开始，主要用到：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// web框架 前端模版</span></span><br><span class="line">express + art-template</span><br><span class="line"><span class="comment">// 自动化构建 打包(sass)</span></span><br><span class="line">gulp + webpack +</span><br><span class="line"><span class="comment">// 浏览器刷新 node重启 热加载</span></span><br><span class="line">browser-sync + nodemon + webpack-hot-middleware</span><br></pre></td></tr></table></figure></p>
<p>然后新建项目，这里用express应用生成器,具体可以看<a href="http://www.expressjs.com.cn/starter/generator.html" target="_blank" rel="external">这里</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可能要求权限，所以sudo，然后感谢淘宝</span></span><br><span class="line">sudo cnpm install express-generator -g </span><br><span class="line"><span class="comment">//express + 项目名</span></span><br><span class="line">express myapp</span><br><span class="line"><span class="comment">//然后一路回车，塔哒，然后就好了</span></span><br></pre></td></tr></table></figure>
<p>生成的项目模版引擎默认用的<code>jade</code>,前几天突然发现了国人的一款引擎<code>art-template</code>,性能强劲，语法干净，express亲和力又强，这次就用上了！<a href="http://aui.github.io/artTemplate/" target="_blank" rel="external">贴上地址</a>.</p>
<p>首先项目目录请看<a href="https://github.com/waynecz/Thrones" target="_blank" rel="external">这里</a>，然后是webpack的配置，webpack的入门看<a href="http://zhuanlan.zhihu.com/p/20367175?columnSlug=FrontendMagazine" target="_blank" rel="external">这里</a>,先这样简单配置webpack.config.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path         = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack      = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//一些文件夹的路径</span></span><br><span class="line"><span class="keyword">var</span> ROOT_PATH  = path.resolve(__dirname);</span><br><span class="line"><span class="keyword">var</span> SRC_PATH   = path.resolve(ROOT_PATH, <span class="string">'src'</span>);</span><br><span class="line"><span class="keyword">var</span> MODULE_PATH = path.resolve(ROOT_PATH, <span class="string">'./node_modules'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = </span><br><span class="line">	<span class="comment">// context webpack处理entry选项时的基础路径</span></span><br><span class="line">    context: path.join(__dirname, <span class="string">'public'</span>),</span><br><span class="line">    entry  : [</span><br><span class="line">    	<span class="comment">// 会寻找src目录下的index.js</span></span><br><span class="line">        <span class="string">'../src'</span></span><br><span class="line">        ],</span><br><span class="line">    output : &#123;</span><br><span class="line">        path      : <span class="string">'/'</span>,</span><br><span class="line">        filename  : <span class="string">'bundle.js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span> : &#123;</span><br><span class="line">        loaders: [</span><br><span class="line">            &#123;</span><br><span class="line">                test   : <span class="regexp">/\.scss$/</span>,</span><br><span class="line">                <span class="comment">// CSS预处理器们</span></span><br><span class="line">                loaders: [<span class="string">'style'</span>, <span class="string">'css'</span>, <span class="string">'postcss'</span>, <span class="string">'sass'</span>],</span><br><span class="line">                include: SRC_PATH</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 选择postcss生效的插件</span></span><br><span class="line">    postcss: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [autoprefixer];</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">      	  <span class="comment">// 为了全局依赖jQuery定义的地址缩写</span></span><br><span class="line">          jquery: <span class="string">"../node_modules/jquery/dist/jquery.min"</span></span><br><span class="line">      &#125;  </span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 全局依赖jQuery</span></span><br><span class="line">        <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">            $: <span class="string">"jquery"</span>,</span><br><span class="line">            jQuery: <span class="string">"jquery"</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>现在基本功能就是css和js打包啦，接下来加进重点，也就是热加载功能。只要你修改了webpack打包的文件，webpack会在不刷新浏览器的情况下替换掉原来的文件,无比顺畅，这里有篇<a href="http://andrewhfarmer.com/webpack-hmr-tutorial/" target="_blank" rel="external">文章</a>非常非常推荐，里面很清晰的讲了webpack在各种情况下<code>热加载</code>的实现。进入正题，首先亮出webpack配合express的兵刃:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 热加载中间件</span></span><br><span class="line">npm install webpack-hot-middleware --save-dev</span><br><span class="line"><span class="comment">// 这个没怎么理解，感觉是生成一个虚拟的环境用来存放打包文件</span></span><br><span class="line">npm install webpack-dev-middleware --save-dev</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure></p>
<p>接接下来，修改<code>webpack.config.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改entry,output和plugins</span></span><br><span class="line">......</span><br><span class="line">entry  : [</span><br><span class="line">	<span class="comment">// 自己暂时理解为热加载文件存放的虚拟地址，请指正</span></span><br><span class="line">	<span class="string">'webpack-hot-middleware/client?path=/__webpack_hmr&amp;timeout=20000'</span>,</span><br><span class="line">	<span class="string">'../src'</span></span><br><span class="line">],</span><br><span class="line">output : &#123;</span><br><span class="line">    path      : <span class="string">'/'</span>,</span><br><span class="line">    filename  : <span class="string">'bundle.js'</span>,</span><br><span class="line">    <span class="comment">// 加入publicPath</span></span><br><span class="line">    publicPath: <span class="string">'/javascripts'</span></span><br><span class="line">&#125;,</span><br><span class="line">.....</span><br><span class="line">plugins: [</span><br><span class="line">	<span class="comment">// 添加下面三行</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.OccurenceOrderPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.NoErrorsPlugin(),</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">        $: <span class="string">"jquery"</span>,</span><br><span class="line">        jQuery: <span class="string">"jquery"</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>webpack配置暂时到这，然后进express的配置，这里我的是<code>app.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加入下面这些，有个奇怪的表现，我吧下面这些代码放在整个文件的位置不同会导致</span></span><br><span class="line"><span class="comment">// 功能失效，最后我放在了文件的头部。。</span></span><br><span class="line"><span class="keyword">var</span> webpackDevMiddleware = <span class="built_in">require</span>(<span class="string">"webpack-dev-middleware"</span>);</span><br><span class="line"><span class="keyword">var</span> webpackHotMiddleware = <span class="built_in">require</span>(<span class="string">"webpack-hot-middleware"</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> webpackConfig = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line"><span class="keyword">var</span> compiler = webpack(webpackConfig);</span><br><span class="line"></span><br><span class="line">app.use(webpackDevMiddleware(compiler, &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    <span class="comment">// 这个publicPath就是webpack里output里的那个，自己理解为dev环境下存放打包后文件的路径</span></span><br><span class="line">    publicPath: webpackConfig.output.publicPath,</span><br><span class="line">    stats: &#123;</span><br><span class="line">        colors: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    historyApiFallback: <span class="literal">true</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.use(webpackHotMiddleware(compiler, &#123;</span><br><span class="line">    log: <span class="built_in">console</span>.log,</span><br><span class="line">    <span class="comment">// 这个path对应entry里的path</span></span><br><span class="line">    path: <span class="string">'/__webpack_hmr'</span>,</span><br><span class="line">    heartbeat: <span class="number">10</span> * <span class="number">1000</span>,</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure></p>
<p>最后在前端里引入打包文件，这样：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 其实可以看到前面webpack的context配置为 /public --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 然后 output 的 publicPath 设置为 /javascripts --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 所以 最后引用的地址为 (public/) javascripts/bundle.js --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"javascripts/bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>塔哒，到这基本就粗略的实现了express加webpack的<em>打包文件!!</em>热加载，对，只有打包的文件，对于其他文件，比如<code>node的后端代码</code>和<em>这里的artTemplate应用在node中是缓存在内存当中的所以直接修改模版文件必须要重启下服务然后刷新浏览器才能做到视图更新</em></p>
<p>其实说白了就是监听这些文档的变化然后重启服务并刷新浏览器！！<br>分成两部可能更清晰点</p>
<ul>
<li>监听并重启服务</li>
<li>在服务重启完成后刷新浏览器</li>
</ul>
<p>这里要注意的其实就是重启服务需要点时间，看具体依赖情况，我这里大概需要1秒，所以刷新浏览器需要有个延迟，在服务完全重启完毕后再执行</p>
<p>先上依靠<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br><span class="line">npm install gulp-nodemon --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br><span class="line"><span class="comment">// browser-sync很有趣的，会代理起一个服务器，本身也拥有热加载功能(原理好像也是webpack？）</span></span><br><span class="line"><span class="comment">// 这里主要用来监听文件变化延迟刷新浏览器。</span></span><br><span class="line">npm install browser-sync --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure></p>
<p>配置<code>gulpfile.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> nodemon = <span class="built_in">require</span>(<span class="string">'gulp-nodemon'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> bs = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>).create();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ROOT = path.resolve(__dirname);</span><br><span class="line"><span class="keyword">var</span> APP = path.resolve(ROOT, <span class="string">'app.js'</span>);</span><br><span class="line"><span class="keyword">var</span> ROUTERS = path.resolve(ROOT, <span class="string">'routes'</span>);</span><br><span class="line"><span class="keyword">var</span> VIEW =  path.resolve(ROOT, <span class="string">'views'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// browser-sync配置，配置里启动nodemon任务</span></span><br><span class="line">gulp.task(<span class="string">'browser-sync'</span>, [<span class="string">'nodemon'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    bs.init(<span class="literal">null</span>, &#123;</span><br><span class="line">    	<span class="comment">// 这里因为express默认起的是3000端口，所以代理3000端口到4000，随自己改</span></span><br><span class="line">        proxy: <span class="string">"http://localhost:3000"</span>,</span><br><span class="line">        port: <span class="number">4000</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// browser-sync 监听文件</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'browser-sync'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.watch([<span class="string">'./routes/**/*.js'</span>,<span class="string">'./modules/*'</span>,<span class="string">'./database/*'</span>, <span class="string">'./app.js'</span>, <span class="string">'./bin/www'</span>,<span class="string">'./views/**/*.html'</span>], [<span class="string">'bs-delay'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 延时刷新</span></span><br><span class="line">gulp.task(<span class="string">'bs-delay'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        bs.reload();</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'重启完毕!'</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'nodemon'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 设个变量来防止重复重启</span></span><br><span class="line">    <span class="keyword">var</span> started = <span class="literal">false</span>;</span><br><span class="line">    nodemon(&#123;</span><br><span class="line">        script: <span class="string">'./bin/www'</span>,</span><br><span class="line">        <span class="comment">// 监听文件的后缀</span></span><br><span class="line">        ext: <span class="string">"js html"</span>,                </span><br><span class="line">        env: &#123; <span class="string">'NODE_ENV'</span>: <span class="string">'development'</span> &#125;,</span><br><span class="line">        <span class="comment">// 监听的路径</span></span><br><span class="line">        watch: [</span><br><span class="line">            ROUTERS,</span><br><span class="line">            APP,</span><br><span class="line">            VIEW</span><br><span class="line">        ]        </span><br><span class="line">    &#125;).on(<span class="string">'start'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">            cb();</span><br><span class="line">            started = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>这里可以看到，nodemon监听的文件一旦有变动后就会重启node，与此同时，其实BS也监听着这些后端文件包括artTemplate模版文件，所以一旦有改动这里再2秒后刷新浏览器。到这里差不多就可以完全解放刷新键了！</p>
<p>真实的体验效果么也还行，偶尔会抽风，还在继续改进。最后</p>
<p>收工！梅干菜丝瓜蛋汤！</p>
<p><img src="http://ali.xinshipu.cn/20130319/original/1363661582619.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/11.jpg" alt=""></p>
<p>主要是为了彻底解放刷新键。。。。。咳咳。开始<br>之前接触React时解除了webpack，不过后来看angular和其他事就搁置了。最近碰到Vue时，体验了下<a href="http://cn.vuejs.org/guide/application.html">vue-cli 脚手架</a>构建的项目，只能说，<em>哇！！</em> 好爽。。什么热加载，保存时检查代码，单元测试以及一堆我还不知道的但是很强大的功能！无比顺畅<br>]]>
    
    </summary>
    
      <category term="自动化构建" scheme="http://waynecz.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[从git+add+commit+push 到 gamp!]]></title>
    <link href="http://waynecz.github.io/2016/03/06/%E4%BB%8Egit-add-commit-push-%E5%88%B0gamp/"/>
    <id>http://waynecz.github.io/2016/03/06/从git-add-commit-push-到gamp/</id>
    <published>2016-03-06T09:29:52.000Z</published>
    <updated>2016-04-11T13:35:45.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/14.jpg" alt=""></p>
<p>啊，新功能写完啦，提交！</p>
<p><img src="http://easyread.ph.126.net/NC4naiTyBWUaQ5-JdmyvEg==/7917079655292253559.gif" alt=""><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span> .</span><br><span class="line">git commit <span class="string">"new feature"</span></span><br><span class="line">git <span class="keyword">push</span></span><br></pre></td></tr></table></figure></p>
<p>咦？好想有个字写错了，没事，改！改完，提交！<br><a id="more"></a><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span> .</span><br><span class="line">git commit <span class="string">"fix word"</span></span><br><span class="line">git <span class="keyword">push</span></span><br></pre></td></tr></table></figure></p>
<p>喔？这里还不如这样，再来！</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span> .</span><br><span class="line">git commit <span class="string">"xixixi"</span></span><br><span class="line">git <span class="keyword">push</span></span><br></pre></td></tr></table></figure>
<p>。。。。。。。。。</p>
<p>虽然不会每次都这么极端，但是有时候按步骤提交真的很烦。。</p>
<p>来点alias?好啊，这么做(以下均osx下为准，装载itern和ohmyzsh)<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开这个.bash_profile </span></span><br><span class="line">vi ~/.bash_profile </span><br><span class="line"></span><br><span class="line"><span class="comment">// 加入下面这些</span></span><br><span class="line"><span class="keyword">alias</span> gaa=<span class="string">"git add ."</span></span><br><span class="line"><span class="keyword">alias</span> gm=<span class="string">"git commit -m "</span></span><br><span class="line"><span class="keyword">alias</span> gp=<span class="string">"git push"</span></span><br><span class="line"><span class="keyword">alias</span> gc=<span class="string">"git checkout"</span></span><br><span class="line"><span class="keyword">alias</span> gcb=<span class="string">"git checkout -b"</span></span><br><span class="line">...<span class="comment">// 其他看着加</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//然后</span></span><br><span class="line">vi ~/.zshrc </span><br><span class="line"><span class="comment">//加入下面这段</span></span><br><span class="line"><span class="keyword">source</span> ~/.nash_profile <span class="comment">//这样每次zsh的shell启动都会初始化alias了</span></span><br></pre></td></tr></table></figure></p>
<p>保存,然后！<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提交就变成了</span></span><br><span class="line">gaa</span><br><span class="line">gm <span class="string">""</span></span><br><span class="line">gp</span><br></pre></td></tr></table></figure></p>
<p>就只需要这样了，<em>BUT</em> 一次提交还是要三行命令啊！敢不敢再短点？！好吧接下去新建一个<code>gitpush.sh</code>，里面内容写：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash.sh</span><br><span class="line"></span></span><br><span class="line"><span class="comment">#添加所有文件到本地仓库</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment">#提交文件到本地仓库</span></span><br><span class="line">git commit -m <span class="string">"<span class="variable">$1</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提交到远程分支</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<p>OK，保存到｀~/shell｀ 下<br>然后<code>vi ~/.bash_profile</code>加入这句</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alias</span> gamp=<span class="string">"sh ~/shell/gitpush.sh"</span> <span class="comment">// 这里只要指定文件就行</span></span><br></pre></td></tr></table></figure>
<p>嘻嘻嘻，使用的话</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">gamp</span> <span class="string">"something"</span></span><br></pre></td></tr></table></figure>
<p>煲仔饭！再见（最后谢敏强，因为这一切其实是他的做的！）</p>
<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/12.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/14.jpg" alt=""></p>
<p>啊，新功能写完啦，提交！</p>
<p><img src="http://easyread.ph.126.net/NC4naiTyBWUaQ5-JdmyvEg==/7917079655292253559.gif" alt=""><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span> .</span><br><span class="line">git commit <span class="string">"new feature"</span></span><br><span class="line">git <span class="keyword">push</span></span><br></pre></td></tr></table></figure></p>
<p>咦？好想有个字写错了，没事，改！改完，提交！<br>]]>
    
    </summary>
    
      <category term="shell" scheme="http://waynecz.github.io/tags/shell/"/>
    
      <category term="计算机" scheme="http://waynecz.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Ajax的懒人姿势]]></title>
    <link href="http://waynecz.github.io/2016/03/05/Ajax%E7%9A%84%E6%87%92%E4%BA%BA%E5%A7%BF%E5%8A%BF/"/>
    <id>http://waynecz.github.io/2016/03/05/Ajax的懒人姿势/</id>
    <published>2016-03-05T01:56:02.000Z</published>
    <updated>2016-04-05T15:55:18.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/13.jpg" alt=""></p>
<p>jq的ajax是个好东西，之前每次是这么写的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.xhrCtrl = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> doAjax = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (xhr.doAjax)&#123;</span><br><span class="line">		<span class="comment">// 重复点击控制</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//按钮控制</span></span><br><span class="line">	$(<span class="string">"#theButton"</span>).prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</span><br><span class="line">	</span><br><span class="line">	xhr.doAjax = <span class="literal">true</span>;	</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: url</span><br><span class="line">	    type: <span class="string">"post"</span>,</span><br><span class="line">	    dataType: <span class="string">"json"</span>,</span><br><span class="line">	    data: postData</span><br><span class="line">	&#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// Ajax 调用成功执行</span></span><br><span class="line">	    <span class="comment">// do something</span></span><br><span class="line">	&#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// Ajax 调用失败执行</span></span><br><span class="line">	    <span class="built_in">console</span>.log(<span class="string">'Fail!'</span>);</span><br><span class="line">	&#125;).always(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// 不管成功与否，都会执行</span></span><br><span class="line">    	xhr.doAjax = <span class="literal">null</span>;</span><br><span class="line">   		$(<span class="string">"#theButton"</span>).prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>写多了就发现，其实业务交互都在<code>.done()</code>里处理，<code>.fail()</code>和<code>.always()</code>看起来都是些重复处理的动作。然后再看异步流程控制时看到了<a href="https://segmentfault.com/a/1190000003691961" target="_blank" rel="external">这个！</a></p>
<p>抽出来说就是写个公共的ajax方法来让每次ajax都只要处理<code>.done()</code>多酷！！主要用到JQ的异步控制，主角就是<code>Deferred</code> 和 <code>Promise</code>,这两个的关系就是：</p>
<ul>
<li>Deffered 触发 resolve 或 reject</li>
<li>Promise 中申明 resolve 或 reject 后应该做什么（回调） </li>
</ul>
<p>初步改善代码,这里封装在jQuery对象上<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">    $.extend(&#123;</span><br><span class="line">        jax: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="keyword">default</span> = &#123;</span><br><span class="line">                data  : &#123;&#125;,</span><br><span class="line">                <span class="keyword">async</span> : <span class="literal">true</span>,</span><br><span class="line">                type  : <span class="string">'post'</span>,</span><br><span class="line">                ctrl  : <span class="string">''</span>,</span><br><span class="line">                button: <span class="literal">undefined</span>,</span><br><span class="line">                errmsg: <span class="string">'服务器炸了,稍后再试吧 - -||'</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> setting = $.extend(<span class="keyword">default</span>, options);</span><br><span class="line">			</span><br><span class="line">	    <span class="comment">// 提交控制</span></span><br><span class="line">            <span class="keyword">if</span> (setting.ctrl) &#123;</span><br><span class="line">                xhrCtrl[setting.ctrl] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 按钮控制</span></span><br><span class="line">            <span class="keyword">if</span> (setting.button) &#123;</span><br><span class="line">                setting.button.prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 等待动画</span></span><br><span class="line">            $(<span class="string">'#ajaxLoader'</span>).fadeIn(<span class="number">150</span>);</span><br><span class="line">			</span><br><span class="line">	    <span class="comment">// 创建一个deferred对象</span></span><br><span class="line">            <span class="keyword">var</span> deferred = $.Deferred();</span><br><span class="line"></span><br><span class="line">            $.ajax(setting.url, &#123;</span><br><span class="line">                type    : setting.type,</span><br><span class="line">                dataType: <span class="string">'json'</span>,</span><br><span class="line">                <span class="keyword">async</span>   : setting.async,</span><br><span class="line">                data    : setting.data</span><br><span class="line">            &#125;).done(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            	 <span class="comment">// 第一个注意点，根据后台灵活调整</span></span><br><span class="line">                <span class="keyword">if</span> (data &amp;&amp; !data.success) &#123;</span><br><span class="line">                	<span class="comment">//假设消息提示为$.toast</span></span><br><span class="line">                    $.toast(data.msg || <span class="string">"发生了奇异的错误"</span>);</span><br><span class="line">                    </span><br><span class="line">                    deferred.reject();</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data &amp;&amp; data.success) &#123;</span><br><span class="line">                	<span class="comment">//  成功，传递数据</span></span><br><span class="line">                    deferred.resolve(data);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $.toast(<span class="string">"oops! 服务器未返回任何数据"</span>);</span><br><span class="line">                    </span><br><span class="line">                    deferred.reject();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).fail(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $.toast(setting.errmsg, <span class="string">'warning'</span>);</span><br><span class="line">                </span><br><span class="line">                deferred.reject();</span><br><span class="line">            &#125;).always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (setting.ctrl) &#123;</span><br><span class="line">                    xhrCtrl[setting.ctrl] = <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (setting.button) &#123;</span><br><span class="line">                    setting.button.prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                $(<span class="string">'#ajaxLoader'</span>).fadeOut(<span class="number">150</span>);</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span> deferred.promise();</span><br><span class="line">        &#125;,</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure></p>
<p>调用的话简直干净！！！！！:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> doAjax = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	$.jax(&#123;</span><br><span class="line">		url   : url,</span><br><span class="line">	    data  : postData,</span><br><span class="line">	    button: $(<span class="string">'#button'</span>),</span><br><span class="line">	    ctrl  : <span class="string">'doAjax'</span></span><br><span class="line">	&#125;).done(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">		<span class="comment">//do something</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>不过这里有几个注意点，第一个注意点就是需要和后台约定下返回数据中success标识的结构，然后，然后就没有然后了，就是这么简单</p>
<p><img src="http://i40.tinypic.com/w8we8m.jpg" alt="笑"><br>世界和平，火锅好吃，再见。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/13.jpg" alt=""></p>
<p>jq的ajax是个好东西，之前每次是这么写的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.xhrCtrl = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> doAjax = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (xhr.doAjax)&#123;</span><br><span class="line">		<span class="comment">// 重复点击控制</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//按钮控制</span></span><br><span class="line">	$(<span class="string">"#theButton"</span>).prop(<span class="string">'disabled'</span>, <span class="literal">true</span>);</span><br><span class="line">	</span><br><span class="line">	xhr.doAjax = <span class="literal">true</span>;	</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: url</span><br><span class="line">	    type: <span class="string">"post"</span>,</span><br><span class="line">	    dataType: <span class="string">"json"</span>,</span><br><span class="line">	    data: postData</span><br><span class="line">	&#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// Ajax 调用成功执行</span></span><br><span class="line">	    <span class="comment">// do something</span></span><br><span class="line">	&#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// Ajax 调用失败执行</span></span><br><span class="line">	    <span class="built_in">console</span>.log(<span class="string">'Fail!'</span>);</span><br><span class="line">	&#125;).always(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	    <span class="comment">// 不管成功与否，都会执行</span></span><br><span class="line">    	xhr.doAjax = <span class="literal">null</span>;</span><br><span class="line">   		$(<span class="string">"#theButton"</span>).prop(<span class="string">'disabled'</span>, <span class="literal">false</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://waynecz.github.io/tags/javascript/"/>
    
      <category term="jquery" scheme="http://waynecz.github.io/tags/jquery/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CSS动画优雅降级的简单总结]]></title>
    <link href="http://waynecz.github.io/2016/02/01/%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E6%9F%90%E4%B8%AACSS%E5%B1%9E%E6%80%A7/"/>
    <id>http://waynecz.github.io/2016/02/01/判断当前浏览器是否支持某个CSS属性/</id>
    <published>2016-02-01T03:20:16.000Z</published>
    <updated>2016-04-05T15:53:06.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/Rough%20Sea.jpg" alt=""></p>
<p>虽然一直在现在的项目中用css动画，但是没去仔细思考兼容问题，现在做个思路总结</p>
<p>列几个 <a href="http://caniuse.com" target="_blank" rel="external">CSS动画相关属性的兼容图</a>:</p>
<ol>
<li><code>animation / keyframes</code> 浏览器支持情况 :<br><img src="http://7xntdk.com1.z0.glb.clouddn.com/animation-caniuse.png" alt="animation浏览器支持情况"><a id="more"></a></li>
<li><code>transform 2D</code> 浏览器支持情况 :<br><img src="http://7xntdk.com1.z0.glb.clouddn.com/transform2d-caniuse.png" alt="transform2D浏览器支持情况"></li>
<li><code>transform 3D / perspective</code> 浏览器支持情况 :<br><img src="http://7xntdk.com1.z0.glb.clouddn.com/perspective-caniuse.png" alt="transform2D浏览器支持情况"></li>
<li><code>transition</code> 浏览器支持情况 :<br><img src="http://7xntdk.com1.z0.glb.clouddn.com/transition-caniuse.png" alt="transition 浏览器支持情况"></li>
</ol>
<p>可以看到动画在IE8（<em>这里主要讨论IE</em>）及以下完全不支持，IE9由于只支持<code>transform(非transform3d)</code>所以也和css动画 <strong>say goodbye</strong> 了。<br>但是项目一定要兼容IE9，又不肯因为一个浏览器放弃整个迪士尼，怎么办？</p>
<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/depu.gif" alt="">  </p>
<p>优雅降级咯，先说下一个简单的小例子：<code>一个元素在页面加载时渐进入页面</code>，上面可以我看到气势IE9不支持animation和transform3d以及transition，所以一个的方案就是让IE9没有动画（主要就是让IE9下元素呆在动画结束的最后位置），这里元素初始状态需要在画面外并且是隐身，看代码    </p>
<p>HTML<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"a"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>CSS<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">div</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">  <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#3ea5ff</span></span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.a</span> <span class="rules">&#123; <span class="comment">/*a初始化元素动画前样式及加入动画*/</span></span><br><span class="line">  <span class="rule"><span class="attribute">transform</span>:<span class="value"> <span class="function">translate3d</span>(-<span class="number">300px</span>,<span class="number">0</span>,<span class="number">0</span>)</span></span>;<span class="comment">/*现代浏览器下移开元素*/</span></span><br><span class="line">  <span class="rule"><span class="attribute">-ms-transform</span>:<span class="value"> <span class="function">translate3d</span>(-<span class="number">300px</span>,<span class="number">0</span>,<span class="number">0</span>)</span></span>;<span class="comment">/*IE10+下移开元素*/</span></span><br><span class="line">  <span class="rule"><span class="attribute">opacity</span>:<span class="value"> <span class="number">0</span></span></span>;<span class="comment">/*透明元素*/</span></span><br><span class="line">  <span class="rule"><span class="attribute">opacity</span>:<span class="value"><span class="number">1</span>\<span class="number">9</span>\<span class="number">0</span></span></span>; <span class="comment">/*IE9hack，是元素不透明*/</span></span><br><span class="line">  <span class="rule"><span class="attribute">animation</span>:<span class="value"> leftIn .<span class="number">7s</span> ease-out forwards</span></span>;  </span><br><span class="line">  </span><br><span class="line">&#125;</span></span><br><span class="line"><span class="at_rule">@<span class="keyword">keyframes</span> leftIn </span>&#123;</span><br><span class="line">  0% <span class="rules">&#123;<span class="rule"><span class="attribute">transform</span>:<span class="value"> <span class="function">translate3d</span>(-<span class="number">300px</span>,<span class="number">0</span>,<span class="number">0</span>)</span></span>;<span class="rule"><span class="attribute">opacity</span>:<span class="value"> <span class="number">0</span>&#125;</span><br><span class="line">  <span class="number">100%</span> &#123;transform: <span class="function">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span></span>;<span class="rule"><span class="attribute">opacity</span>:<span class="value"> <span class="number">1</span>&#125;</span><br><span class="line">&#125;</span></span></span></span><br></pre></td></tr></table></figure></p>
<p>好简单是不是。。主要功臣自然是<code>translate3d</code>,因为IE9不支持自然会忽略掉，所以translate也在IE下不起效了，opacity等简单属性做个hack即可。</p>
<p>接下来随便写下第二种的思路，用JQ动画来替代，还是上面那个例子吧：<br>首先当然要判断浏览器支不支持要用到的CSS属性，判断函数如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isSupportThis</span>(<span class="params">attrName</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> prefixs = [<span class="string">'webkit'</span>, <span class="string">'Moz'</span>, <span class="string">'ms'</span>, <span class="string">'o'</span>],</span><br><span class="line">		i,</span><br><span class="line">		humpString = [],</span><br><span class="line">		htmlStyle = <span class="built_in">document</span>.documentElement.style,</span><br><span class="line">		<span class="comment">// 将animation-delay这种带杠转化为htmlStyle中的驼峰属性名</span></span><br><span class="line">		toHumb = <span class="function"><span class="keyword">function</span> (<span class="params">string</span>) </span>&#123;</span><br><span class="line"> 			<span class="keyword">return</span> string.replace(<span class="regexp">/-(\w)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$0, $1</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">return</span> $<span class="number">1.</span>toUpperCase();</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (i <span class="keyword">in</span> prefixs) &#123;</span><br><span class="line">		humpString.push(toHumb(prefixs[i] + <span class="string">'-'</span> + attrName))</span><br><span class="line">	&#125;;</span><br><span class="line"> </span><br><span class="line">	humpString.push(toHumb(attrName));</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (i <span class="keyword">in</span> humpString) &#123;</span><br><span class="line">		<span class="keyword">if</span> (humpString[i] <span class="keyword">in</span> htmlStyle) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">isSupportThis(<span class="string">'animation'</span>) <span class="comment">// IE9下false</span></span><br></pre></td></tr></table></figure>
<p>然后如果不支持的话就对<code>$(&#39;.a&#39;)</code>做下动画处理，当然，如果动画元素很多且很杂，我们可以事先未那些要进行动画的元素统一加上<code>class=&quot;animation&quot;</code>之类的后面好处理，<code>animation-delay</code>之类的也可以用<code>delay()</code>代替</p>
<p>就到这</p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/Rough%20Sea.jpg" alt=""></p>
<p>虽然一直在现在的项目中用css动画，但是没去仔细思考兼容问题，现在做个思路总结</p>
<p>列几个 <a href="http://caniuse.com">CSS动画相关属性的兼容图</a>:</p>
<ol>
<li><code>animation / keyframes</code> 浏览器支持情况 :<br><img src="http://7xntdk.com1.z0.glb.clouddn.com/animation-caniuse.png" alt="animation浏览器支持情况">]]>
    
    </summary>
    
      <category term="css3" scheme="http://waynecz.github.io/tags/css3/"/>
    
      <category term="javascript" scheme="http://waynecz.github.io/tags/javascript/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[自己几个常用的CSS片段,多为CSS3]]></title>
    <link href="http://waynecz.github.io/2016/01/25/%E7%BA%AA%E5%BD%95%E5%87%A0%E4%B8%AACSS%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"/>
    <id>http://waynecz.github.io/2016/01/25/纪录几个CSS奇技淫巧/</id>
    <published>2016-01-25T07:10:36.000Z</published>
    <updated>2016-04-05T15:03:35.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/shushu.jpeg" alt="叔叔"></p>
<h2 id="偶尔添加">偶尔添加</h2><ol>
<li><p>除去最后一个li的边框</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="rule"><span class="attribute">li</span>:<span class="value"><span class="function">not</span>(:last-child) &#123;</span><br><span class="line">	border: <span class="number">1px</span> solid black</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>浏览器支持情况：<strong>IE9+</strong></p>
</li>
</ol>
<a id="more"></a>
<ol>
<li><p>文字过长省略号显示             </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">p</span> <span class="rules">&#123;</span><br><span class="line">	<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">text-overflow</span>:<span class="value"> clip</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">white-space</span>:<span class="value"> nowrap</span></span>; <span class="comment">/*强制不换行*/</span></span><br><span class="line"> &#125;</span></span><br></pre></td></tr></table></figure>
<p>浏览器支持情况：<strong>IE11都不支持！firefox加前缀</strong></p>
</li>
<li><p>去浮动，撑开元素！其实一般情况之遥氟元素一个<code>overflow:hidden</code>就可以了</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.clearfix &#123;</span><br><span class="line">	*zoom: 1; /* 兼容IE*/</span><br><span class="line"> &#125;</span><br><span class="line"> .clearfix:after &#123;</span><br><span class="line">	content: '\200B' ; /* 空字符*/</span><br><span class="line">	display: block;</span><br><span class="line">	height: 0;</span><br><span class="line">	clear: both;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>浏览器支持情况：<strong>allllllll</strong>      </p>
</li>
<li>绝对居中<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.parent</span> <span class="rules">&#123;</span><br><span class="line">	<span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>; </span><br><span class="line">  &#125;</span></span><br><span class="line"> <span class="class">.child</span> <span class="rules">&#123;</span><br><span class="line">	<span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">right</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">bottom</span>:<span class="value"> <span class="number">0</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">margin</span>:<span class="value"> auto</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">999px</span></span></span>;</span><br><span class="line">	<span class="comment">/* 这个方案需要子容器有一个固定的高，或百分比自适应于外部。它的高度不能是height:auto*/</span></span><br><span class="line"> &#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/shushu.jpeg" alt="叔叔"></p>
<h2 id="偶尔添加">偶尔添加</h2><ol>
<li><p>除去最后一个li的边框</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="rule"><span class="attribute">li</span>:<span class="value"><span class="function">not</span>(:last-child) &#123;</span><br><span class="line">	border: <span class="number">1px</span> solid black</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>浏览器支持情况：<strong>IE9+</strong></p>
</li>
</ol>]]>
    
    </summary>
    
      <category term="css3" scheme="http://waynecz.github.io/tags/css3/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[［摘抄］一次网页访问各互联网协议实例]]></title>
    <link href="http://waynecz.github.io/2016/01/12/%E4%B8%80%E6%AC%A1%E7%BD%91%E9%A1%B5%E8%AE%BF%E9%97%AE%E5%90%84%E4%BA%92%E8%81%94%E7%BD%91%E5%8D%8F%E8%AE%AE%E5%AE%9E%E4%BE%8B/"/>
    <id>http://waynecz.github.io/2016/01/12/一次网页访问各互联网协议实例/</id>
    <published>2016-01-12T11:20:16.000Z</published>
    <updated>2016-04-05T15:03:25.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/xingkong.jpg" alt="家门口"><br>摘抄自阮大的<a href="http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html" target="_blank" rel="external">互联网协议入门</a>首先假定这是本机器设置</p>
<pre><code>*  本机的IP地址：<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>
*  子网掩码：<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>
*  网关的IP地址：<span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span>
*  DNS的IP地址：<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>
</code></pre><ol>
<li>访问<code>www.google.com</code><a id="more"></a></li>
<li>DNS协议        <ul>
<li>将网址转化为IP地址，已知DNS服务器为<code>8.8.8.8</code>，于是向这个地址发送一个DNS数据包（53端口），数据包如下<br><img src="http://image.beekka.com/blog/201206/bg2012061105.png" alt="image"><br>然后DNS服务器作出响应，告诉我们<code>Google</code>的IP地址是<code>172.194.72.105</code>。</li>
</ul>
</li>
<li><p>子网掩码</p>
<ul>
<li>解析来判断这个IP地址是不是在同一个子网络，这里用到子网掩码   ，已知子网掩码时<code>255.255.255.0</code>，本机用自己的IP地址<code>192.168.1.100</code>做一个二进制AND运算，计算结果为<code>192.168.1.0</code>，然后对Google的IP也做一下AND运算，结果为<code>172.194.72.0</code>，两个结果不相等，所以不为同一个子网络。                     </li>
<li>因此，我们要向Google发送数据包，<strong>必须通过网管<code>192.168.1.1</code>转发</strong>，也就是说，接收方的MAC地址是网关的MAC地址。</li>
</ul>
</li>
<li><p>应用层协议    </p>
<ul>
<li>浏览网页用的是HTTP协议，他的整个数据包结构是这样的<br><img src="http://image.beekka.com/blog/201206/bg2012061106.png" alt="image"><br>HTTP部分的内容类似于下面这样：    <pre><code><span class="keyword">*</span> GET / HTTP/1.1            
<span class="keyword">*</span> Host: www.google.com      
<span class="keyword">*</span> Connection: keep-alive       
<span class="keyword">*</span> User-Agent: Mozilla/5.0 (Windows NT 6.1) ......    
<span class="keyword">*</span> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,<span class="keyword">*</span>/<span class="keyword">*</span>;q=0.8    
<span class="keyword">*</span> Accept-Encoding: gzip,deflate,sdch    
<span class="keyword">*</span> Accept-Language: zh-CN,zh;q=0.8     
<span class="keyword">*</span> Accept-Charset: GBK,utf-8;q=0.7,<span class="keyword">*</span>;q=0.3    
<span class="keyword">*</span> Cookie: ... ...
</code></pre>我们假定这个部分的长度为<code>4960</code>字节，它被嵌在TCP数据包中。</li>
</ul>
</li>
<li>TCP协议            <ul>
<li>TCP数据包数据包需要设置端口，接收方（Google）的HTTP默认端口是80，发送方（本机）的端口是<code>1024－65535</code>之间的整数，这里假定是51375。</li>
<li>TCP标头的长度为<code>20</code>字节，加上嵌入HTTP数据包，总长度变为<code>4980</code>字节。</li>
</ul>
</li>
<li>IP协议<ul>
<li>然后，TCP数据包再嵌入IP数据包。IP数据包需要设置双方的IP地址，这是已知的，发送方是<code>192.168.1.100</code>（本机），接收方是<code>172.194.72.105</code>（Google）</li>
<li>IP数据包标头为<code>20</code>字节，加上嵌入的TCP数据包，总大小为<code>5000</code>字节。</li>
</ul>
</li>
<li>以太网协议<ul>
<li>最后，IP    数据包嵌入以太网数据包，以太网数据包需要设置双方的MAC地址，发送方为本机的网卡MAC地址，接收方为网关192.168.1.1的MAC地址（通过ARP协议得到，这里ARP即本机<ul>
<li>发送一个包含在以太网数据包中的数据包，其中包含网关的IP地址，在对方的MAC地址这一栏，填<code>FF.FF.FF.FF</code>，表示这是一个<em>广播</em>地址它所在子网络的每一台主机，都会收到这个数据包，从中取出IP地址，与自身的IP地址进行比较。如果两者相同，都做出回复，向对方报告自己的MAC地址，否则就丢弃这个包。）。</li>
</ul>
</li>
<li>以太网数据包的部分，最大长度为<code>1500</code>字节，而现在的IP数据包长度为<code>5000</code>字节，因为每个包都有自己的IP标头（20字节），所以四个的IP数据包长度分别为<code>1500</code>，<code>1500</code>，<code>1500</code>，<code>560</code>。<br><img src="http://image.beekka.com/blog/201206/bg2012061107.png" alt="image"></li>
</ul>
</li>
<li>服务器响应<ul>
<li>经过多个网关转发，Google的服务器<code>172.194.72.105</code>收到了这四个以太网数据包。</li>
<li>根据IP标头的序列号，Google将这四个包拼接起来，取出完整的TCP数据包，然后读出里面的<code>HTTP请求</code>，接着做出<code>HTTP响应</code>，用TCP协议发回去</li>
<li>本机收到HTTP响应以后，就可以将网页显示出来，完成一次网络通信.    </li>
</ul>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/xingkong.jpg" alt="家门口"><br>摘抄自阮大的<a href="http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html">互联网协议入门</a>首先假定这是本机器设置</p>
<pre><code>*  本机的IP地址：<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>
*  子网掩码：<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>
*  网关的IP地址：<span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span>
*  DNS的IP地址：<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>
</code></pre><ol>
<li>访问<code>www.google.com</code>]]>
    
    </summary>
    
      <category term="互网协议" scheme="http://waynecz.github.io/tags/%E4%BA%92%E7%BD%91%E5%8D%8F%E8%AE%AE/"/>
    
      <category term="计算机" scheme="http://waynecz.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[响应式设计下img标签如何设置才在移动端不下载图片]]></title>
    <link href="http://waynecz.github.io/2015/12/24/%E5%93%8D%E5%BA%94%E5%BC%8F%E8%AE%BE%E8%AE%A1%E4%B8%8Bimg%E6%A0%87%E7%AD%BE%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E6%89%8D%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%B8%8D%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87/"/>
    <id>http://waynecz.github.io/2015/12/24/响应式设计下img标签如何设置才在移动端不下载图片/</id>
    <published>2015-12-24T09:22:07.000Z</published>
    <updated>2016-04-05T15:03:06.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/xihelajijiao.jpg" alt="西和垃圾角"></p>
<p>从前在一个页面中有一张很普通的图片，普通到像这个样子</p>
<pre><code>&lt;<span class="tag">img</span> src=<span class="string">"pic.jpg"</span> alt=<span class="string">"pic"</span>/&gt;  
</code></pre><p>然后想要这张图片在移动端(比如<code>max-device-width: 600px</code>)下的时候隐藏该图片，<br>但是直接<code>display:none</code>的话发现浏览器还是会加载，这恐怕对于移动端寸KB寸金的资源来说是一场灾难。  </p>
<p>于是琢磨怎么把图片弄消失掉，秉着能少写就少写写的原则，首先想到<code>img</code>标签的<code>srcset</code>属性。</p>
<a id="more"></a>
<p>关于<code>srcset</code>单个使用，简单的说就是<strong><code>让浏览器根据像素密度切换图片源</code></strong>，类似这个样子：</p>
<pre><code>&lt;<span class="tag">img</span> src=<span class="string">"1.jpg"</span> srcset=<span class="string">" 2.jpg 2x, 3.jpg 3x"</span>/&gt;
</code></pre><p>浏览器默认选择<code>1.jpg</code>，但是当设备像素密度为2的时候比如nexus5加载<code>2.jpg</code>，咦？？！！！有没有想到什么？！！！现在移动端貌似都是高像素比啊！，那我岂不是可以这样！：</p>
<pre><code>&lt;<span class="tag">img</span> src=<span class="string">"pic.jpg"</span> srcset=<span class="string">"null.jpg 1.5x, null.jpg 2x, null.jpg 3x"</span> alt=<span class="string">"以此类推"</span>/&gt;
</code></pre><p> <code>null.jpg</code>是一张并不存在的图片，也可以是一张1K的小图。啊哈哈天真的我真这样写进公司的官网里面去了～ 自测：完美；用别人手机电脑测试：完美！天啊噜，简单到窒</p>
<p> <img src="http://pic.baike.soso.com/p/20130609/bki-20130609135228-704795420.jpg" alt="">  </p>
<p> 红红火火恍恍惚惚哈哈哈哈哈哈哈哈哈哈哈哈哈哈好！～～～～～个屁啊</p>
<p> 嗑嗑，年轻，你听说过苹果有5倍像素比的iMac吧，再听说下Dell的4K屏不错，听说。。。好吧，现在桌面端也早就步入了高清时代，so，这样做在这些设备里图片就是卖女孩的小火柴——全靠意淫。</p>
<p> <img src="http://2d.zol-img.com.cn/product/87/187/cekJDCv3RNGw2.gif" alt=""></p>
<p>好吧，东问西问思索后再三还是得用CSS解决［下面都是把图片作为<code>background-image</code>呈现，这也是我刚开始是想极力避免的，我觉得作为背景就是复杂了，大小控制也不那么简单粗暴（需要通过<code>background-size</code>）］在segmentfault提问之后得到这么一篇文章：<strong><a href="https://timkadlec.com/2012/04/media-query-asset-downloading-results/" target="_blank" rel="external">Media Query &amp; Asset Downloading Results</a></strong></p>
<p>里面很详细的测试了各种方案图片加载情况，我这里就不多废话了，直接上一个有效的方案</p>
<h3 id="嵌套父元素，父元素设置为diaplay:none">嵌套父元素，父元素设置为<code>diaplay:none</code></h3><p>我也叫它 <strong>给一个爸爸，然后打死爸爸，就没有儿子了大法</strong></p>
<pre><code>&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"par"</span>&gt;
    &lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"pic"</span>&gt;&lt;/<span class="keyword">div</span>&gt;
&lt;/<span class="keyword">div</span>&gt;

.pic {
    background-image:url('images/test.png');
    width:<span class="number">200</span>px;
    height:<span class="number">75</span>px;
}
@media all <span class="keyword">and</span> (max-width: <span class="number">600</span>px) {
    .par  {
        display:none;
    }
}
</code></pre><p>结果呢？嘿嘿，异常理想，除了Fennec (10.0+)［火狐开发的移动版本？］照例下载了图片之外，其他各种浏览器都只在大于<code>600px</code>的时候下载了图片，如果不闲套个容器麻烦的话，这是个很好的方案！</p>
<p><img src="http://img0.imgtn.bdimg.com/it/u=235478332,2866600352&amp;fm=11&amp;gp=0.jpg" alt="棒呆"></p>
<p>感谢<strong><a href="http://img0.imgtn.bdimg.com/it/u=235478332,2866600352&amp;fm=11&amp;gp=0.jpg" target="_blank" rel="external">鑫旭大神</a></strong> 和 <strong><a href="http://segmentfault.com/q/1010000004170311?_ea=521263" target="_blank" rel="external">回答过这个问题的大家</a></strong> </p>
<p>平安夜，圣诞快乐！！！！这篇是2015年第一也是最后一篇文章哈哈，明年再见～</p>
<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/shengdan.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xntdk.com1.z0.glb.clouddn.com/xihelajijiao.jpg" alt="西和垃圾角"></p>
<p>从前在一个页面中有一张很普通的图片，普通到像这个样子</p>
<pre><code>&lt;<span class="tag">img</span> src=<span class="string">"pic.jpg"</span> alt=<span class="string">"pic"</span>/&gt;  
</code></pre><p>然后想要这张图片在移动端(比如<code>max-device-width: 600px</code>)下的时候隐藏该图片，<br>但是直接<code>display:none</code>的话发现浏览器还是会加载，这恐怕对于移动端寸KB寸金的资源来说是一场灾难。  </p>
<p>于是琢磨怎么把图片弄消失掉，秉着能少写就少写写的原则，首先想到<code>img</code>标签的<code>srcset</code>属性。</p>]]>
    
    </summary>
    
      <category term="css3" scheme="http://waynecz.github.io/tags/css3/"/>
    
      <category term="html" scheme="http://waynecz.github.io/tags/html/"/>
    
      <category term="移动端" scheme="http://waynecz.github.io/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
      <category term="前端" scheme="http://waynecz.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
</feed>
